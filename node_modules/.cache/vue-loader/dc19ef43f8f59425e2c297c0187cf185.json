{"remainingRequest":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue","mtime":1623388721669},{"path":"E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgcHJvamVjdF9yZXN1bHRfdGFibGUgZnJvbSAnQC9jb21wb25lbnRzL3Byb2plY3RfcmVzdWx0X3RhYmxlLnZ1ZScNCmltcG9ydCByZXN1bHQgZnJvbSAnQC9hcGkvcmVzdWx0Jw0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICdQcm9qZWN0UmVzdWx0JywNCiAgICBjb21wb25lbnRzOiB7DQogICAgICAgIHByb2plY3RfcmVzdWx0X3RhYmxlDQoNCiAgICB9LA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsDQogICAgICAgICAgICBmb3JtOiB7DQogICAgICAgICAgICAgICAgaW1wb3J0X2Zvcm06ICcnLA0KICAgICAgICAgICAgICAgIGRhdGUxOiAnJywNCiAgICAgICAgICAgICAgICBkZWxpdmVyeTogZmFsc2UsDQogICAgICAgICAgICAgICAgdHlwZTogW10sDQogICAgICAgICAgICAgICAgcmVzb3VyY2U6ICcnLA0KICAgICAgICAgICAgICAgIGRlc2M6ICcnDQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICB0YWJsZURhdGE6IFtdLA0KDQogICAgICAgIH0NCiAgICB9LA0KICAgIGNyZWF0ZWQoKSB7DQoNCiAgICAgICAgdGhpcy5nZXRBbGxSZXN1bHQoKQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBnZXRBbGxSZXN1bHQoKSB7DQogICAgICAgICAgICByZXN1bHQuZ2V0QWxsUmVzdWx0KCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpDQogICAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXNwb25zZS5kYXRhLnJlc3VsdExpc3QNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0sDQogICAgICAgIGV4cG9ydEV4Y2VsKCkgew0KICAgICAgICAgICAgbGV0IGFsbGNvbHVtbnMgPSB0aGlzLnRhYmxlRGF0YQ0KICAgICAgICAgICAgdmFyIG5ld2NvbHVtbnMgPSBbXQ0KICAgICAgICAgICAgZm9yIChsZXQgcmUgb2YgYWxsY29sdW1ucykgew0KICAgICAgICAgICAgICAgIHZhciBzdHVkZW50cyA9ICcnDQogICAgICAgICAgICAgICAgZm9yIChsZXQgc3R1ZGVudCBvZiByZS5zdHVkZW50TGlzdCkgew0KICAgICAgICAgICAgICAgICAgICBzdHVkZW50cyArPSAoc3R1ZGVudC5uYW1lICsgJywnKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBuZXdjb2x1bW5zLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBpZDogcmUuaWQsDQogICAgICAgICAgICAgICAgICAgIGdyaWQ6IHJlLmdyaWQsDQogICAgICAgICAgICAgICAgICAgIGZpbmFsSWQ6IHJlLmZpbmFsSWQsDQogICAgICAgICAgICAgICAgICAgIHByb2plY3RUaXRsZTogcmUucHJvamVjdFRpdGxlLA0KICAgICAgICAgICAgICAgICAgICBzdHVkZW50OiBzdHVkZW50cywNCiAgICAgICAgICAgICAgICAgICAgcHJvamVjdENsaWVudDogcmUucHJvamVjdENsaWVudCwNCiAgICAgICAgICAgICAgICAgICAgcHJvamVjdEVtYWlsOiByZS5wcm9qZWN0RW1haWwNCiAgICAgICAgICAgICAgICB9KQ0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJlcXVpcmUuZW5zdXJlKFtdLCAoKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgew0KICAgICAgICAgICAgICAgICAgICBleHBvcnRfanNvbl90b19leGNlbA0KICAgICAgICAgICAgICAgIH0gPSByZXF1aXJlKCcuLi8uLi8uLi9leGNlbC9FeHBvcnQyRXhjZWwuanMnKTsNCiAgICAgICAgICAgICAgICBjb25zdCB0SGVhZGVyID0gWydHcm91cCBJRCcsJ1Byb2plY3QgSUQnLCAnUHJvamVjdCBOYW1lJywgJ1N0dWRlbnRzJywgJ0NsaWVudCBuYW1lJywnQ2xpZW50IEVtYWlsJ107DQogICAgICAgICAgICAgICAgLy8g5LiK6Z2i6K6+572uRXhjZWznmoTooajmoLznrKzkuIDooYznmoTmoIfpopgNCiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJWYWwgPSBbJ2dyaWQnLCAnZmluYWxJZCcsJ3Byb2plY3RUaXRsZScsICdzdHVkZW50JywgJ3Byb2plY3RDbGllbnQnLCdwcm9qZWN0RW1haWwnXTsNCiAgICAgICAgICAgICAgICAvLyDkuIrpnaLnmoRpbmRleOOAgW5pY2tOYW1l44CBbmFtZeaYr3RhYmxlRGF0YemHjOWvueixoeeahOWxnuaApw0KICAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSBuZXdjb2x1bW5zOyAvL+aKimRhdGHph4znmoR0YWJsZURhdGHlrZjliLBsaXN0DQogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGxpc3QpOw0KICAgICAgICAgICAgICAgIGV4cG9ydF9qc29uX3RvX2V4Y2VsKHRIZWFkZXIsIGRhdGEsICdwcm9qZWN0X3Jlc3VsdF90YWJsZScpOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCg0KICAgICAgICBmb3JtYXRKc29uKGZpbHRlclZhbCwganNvbkRhdGEpIHsNCiAgICAgICAgICAgIHJldHVybiBqc29uRGF0YS5tYXAodiA9PiBmaWx0ZXJWYWwubWFwKGogPT4gdltqXSkpDQogICAgICAgIH0NCiAgICB9DQoNCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/allocation/project_result","sourcesContent":["<template>\r\n<div class=\"project-allocation-container\">\r\n    <div class=\"table_container\">\r\n        <div class=\"table_R\">\r\n            <project_result_table></project_result_table>\r\n        </div>\r\n        <div class=\"download\">\r\n            <el-button icon=\"el-icon-download\" circle @click=\"exportExcel()\"></el-button>\r\n\r\n        </div>\r\n    </div>\r\n    <el-dialog title=\"Import\" :visible.sync=\"dialogFormVisible\" width=\"30%\" height=\"30%\">\r\n        <el-form :model=\"form\">\r\n            <el-form-item label=\"Import as:\" :label-width=\"formLabelWidth\">\r\n                <el-select v-model=\"form.import_form\" placeholder=\"Select file format\">\r\n                    <el-option label=\"excel\" value=\"excel\"></el-option>\r\n                    <el-option label=\"doxc\" value=\"doxc\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\" style=\"background:#FFFFFF;\">\r\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" pain @click=\"dialogFormVisible = false; exportExcel()\">确 定</el-button>\r\n        </div>\r\n    </el-dialog>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport project_result_table from '@/components/project_result_table.vue'\r\nimport result from '@/api/result'\r\nexport default {\r\n    name: 'ProjectResult',\r\n    components: {\r\n        project_result_table\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            dialogFormVisible: false,\r\n            form: {\r\n                import_form: '',\r\n                date1: '',\r\n                delivery: false,\r\n                type: [],\r\n                resource: '',\r\n                desc: ''\r\n            },\r\n\r\n            tableData: [],\r\n\r\n        }\r\n    },\r\n    created() {\r\n\r\n        this.getAllResult()\r\n    },\r\n    methods: {\r\n        getAllResult() {\r\n            result.getAllResult().then(response => {\r\n                console.log(response)\r\n                this.tableData = response.data.resultList\r\n            })\r\n        },\r\n        exportExcel() {\r\n            let allcolumns = this.tableData\r\n            var newcolumns = []\r\n            for (let re of allcolumns) {\r\n                var students = ''\r\n                for (let student of re.studentList) {\r\n                    students += (student.name + ',')\r\n                }\r\n                newcolumns.push({\r\n                    id: re.id,\r\n                    grid: re.grid,\r\n                    finalId: re.finalId,\r\n                    projectTitle: re.projectTitle,\r\n                    student: students,\r\n                    projectClient: re.projectClient,\r\n                    projectEmail: re.projectEmail\r\n                })\r\n\r\n            }\r\n\r\n            require.ensure([], () => {\r\n                const {\r\n                    export_json_to_excel\r\n                } = require('../../../excel/Export2Excel.js');\r\n                const tHeader = ['Group ID','Project ID', 'Project Name', 'Students', 'Client name','Client Email'];\r\n                // 上面设置Excel的表格第一行的标题\r\n                const filterVal = ['grid', 'finalId','projectTitle', 'student', 'projectClient','projectEmail'];\r\n                // 上面的index、nickName、name是tableData里对象的属性\r\n                const list = newcolumns; //把data里的tableData存到list\r\n                const data = this.formatJson(filterVal, list);\r\n                export_json_to_excel(tHeader, data, 'project_result_table');\r\n            })\r\n        },\r\n\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => v[j]))\r\n        }\r\n    }\r\n\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.project-allocation-container {\r\n    width: 1156px;\r\n    height: 702px;\r\n    font-size: 14px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.project-allocation-container .table_container {\r\n    width: 1128px;\r\n    height: 685px;\r\n    margin: 25px 20px;\r\n    border-radius: 6px;\r\n    box-shadow: 0 3px 6px 0 rgb(0 0 0 / 12%), 0 0 5px 0 rgb(0 0 0 / 4%);\r\n}\r\n\r\n.project-allocation-container .table_container .table_R {\r\n    width: 1128px;\r\n    height: 610px;\r\n}\r\n\r\n.download {\r\n    width: 1128px;\r\n    height: 70px;\r\n\r\n    .el-button {\r\n        float: right;\r\n        margin: 20px 51px 0 0;\r\n    }\r\n}\r\n</style>\r\n"]}]}