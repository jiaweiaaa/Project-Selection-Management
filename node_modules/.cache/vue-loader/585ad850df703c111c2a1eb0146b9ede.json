{"remainingRequest":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue?vue&type=style&index=0&id=617ea82a&lang=scss&scoped=true&","dependencies":[{"path":"E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue","mtime":1623388721669},{"path":"E:\\project2\\project-allocation-web\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnByb2plY3QtYWxsb2NhdGlvbi1jb250YWluZXIgew0KICAgIHdpZHRoOiAxMTU2cHg7DQogICAgaGVpZ2h0OiA3MDJweDsNCiAgICBmb250LXNpemU6IDE0cHg7DQogICAgbWFyZ2luOiAwIGF1dG87DQp9DQoNCi5wcm9qZWN0LWFsbG9jYXRpb24tY29udGFpbmVyIC50YWJsZV9jb250YWluZXIgew0KICAgIHdpZHRoOiAxMTI4cHg7DQogICAgaGVpZ2h0OiA2ODVweDsNCiAgICBtYXJnaW46IDI1cHggMjBweDsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgYm94LXNoYWRvdzogMCAzcHggNnB4IDAgcmdiKDAgMCAwIC8gMTIlKSwgMCAwIDVweCAwIHJnYigwIDAgMCAvIDQlKTsNCn0NCg0KLnByb2plY3QtYWxsb2NhdGlvbi1jb250YWluZXIgLnRhYmxlX2NvbnRhaW5lciAudGFibGVfUiB7DQogICAgd2lkdGg6IDExMjhweDsNCiAgICBoZWlnaHQ6IDYxMHB4Ow0KfQ0KDQouZG93bmxvYWQgew0KICAgIHdpZHRoOiAxMTI4cHg7DQogICAgaGVpZ2h0OiA3MHB4Ow0KDQogICAgLmVsLWJ1dHRvbiB7DQogICAgICAgIGZsb2F0OiByaWdodDsNCiAgICAgICAgbWFyZ2luOiAyMHB4IDUxcHggMCAwOw0KICAgIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/allocation/project_result","sourcesContent":["<template>\r\n<div class=\"project-allocation-container\">\r\n    <div class=\"table_container\">\r\n        <div class=\"table_R\">\r\n            <project_result_table></project_result_table>\r\n        </div>\r\n        <div class=\"download\">\r\n            <el-button icon=\"el-icon-download\" circle @click=\"exportExcel()\"></el-button>\r\n\r\n        </div>\r\n    </div>\r\n    <el-dialog title=\"Import\" :visible.sync=\"dialogFormVisible\" width=\"30%\" height=\"30%\">\r\n        <el-form :model=\"form\">\r\n            <el-form-item label=\"Import as:\" :label-width=\"formLabelWidth\">\r\n                <el-select v-model=\"form.import_form\" placeholder=\"Select file format\">\r\n                    <el-option label=\"excel\" value=\"excel\"></el-option>\r\n                    <el-option label=\"doxc\" value=\"doxc\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\" style=\"background:#FFFFFF;\">\r\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" pain @click=\"dialogFormVisible = false; exportExcel()\">确 定</el-button>\r\n        </div>\r\n    </el-dialog>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport project_result_table from '@/components/project_result_table.vue'\r\nimport result from '@/api/result'\r\nexport default {\r\n    name: 'ProjectResult',\r\n    components: {\r\n        project_result_table\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            dialogFormVisible: false,\r\n            form: {\r\n                import_form: '',\r\n                date1: '',\r\n                delivery: false,\r\n                type: [],\r\n                resource: '',\r\n                desc: ''\r\n            },\r\n\r\n            tableData: [],\r\n\r\n        }\r\n    },\r\n    created() {\r\n\r\n        this.getAllResult()\r\n    },\r\n    methods: {\r\n        getAllResult() {\r\n            result.getAllResult().then(response => {\r\n                console.log(response)\r\n                this.tableData = response.data.resultList\r\n            })\r\n        },\r\n        exportExcel() {\r\n            let allcolumns = this.tableData\r\n            var newcolumns = []\r\n            for (let re of allcolumns) {\r\n                var students = ''\r\n                for (let student of re.studentList) {\r\n                    students += (student.name + ',')\r\n                }\r\n                newcolumns.push({\r\n                    id: re.id,\r\n                    grid: re.grid,\r\n                    finalId: re.finalId,\r\n                    projectTitle: re.projectTitle,\r\n                    student: students,\r\n                    projectClient: re.projectClient,\r\n                    projectEmail: re.projectEmail\r\n                })\r\n\r\n            }\r\n\r\n            require.ensure([], () => {\r\n                const {\r\n                    export_json_to_excel\r\n                } = require('../../../excel/Export2Excel.js');\r\n                const tHeader = ['Group ID','Project ID', 'Project Name', 'Students', 'Client name','Client Email'];\r\n                // 上面设置Excel的表格第一行的标题\r\n                const filterVal = ['grid', 'finalId','projectTitle', 'student', 'projectClient','projectEmail'];\r\n                // 上面的index、nickName、name是tableData里对象的属性\r\n                const list = newcolumns; //把data里的tableData存到list\r\n                const data = this.formatJson(filterVal, list);\r\n                export_json_to_excel(tHeader, data, 'project_result_table');\r\n            })\r\n        },\r\n\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => v[j]))\r\n        }\r\n    }\r\n\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.project-allocation-container {\r\n    width: 1156px;\r\n    height: 702px;\r\n    font-size: 14px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.project-allocation-container .table_container {\r\n    width: 1128px;\r\n    height: 685px;\r\n    margin: 25px 20px;\r\n    border-radius: 6px;\r\n    box-shadow: 0 3px 6px 0 rgb(0 0 0 / 12%), 0 0 5px 0 rgb(0 0 0 / 4%);\r\n}\r\n\r\n.project-allocation-container .table_container .table_R {\r\n    width: 1128px;\r\n    height: 610px;\r\n}\r\n\r\n.download {\r\n    width: 1128px;\r\n    height: 70px;\r\n\r\n    .el-button {\r\n        float: right;\r\n        margin: 20px 51px 0 0;\r\n    }\r\n}\r\n</style>\r\n"]}]}