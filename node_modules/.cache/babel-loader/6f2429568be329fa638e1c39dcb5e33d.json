{"remainingRequest":"E:\\project2\\project-allocation-web\\node_modules\\babel-loader\\lib\\index.js!E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\project2\\project-allocation-web\\src\\views\\allocation\\project_result\\index.vue","mtime":1623388721669},{"path":"E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\project2\\project-allocation-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkU6L3Byb2plY3QyL3Byb2plY3QtYWxsb2NhdGlvbi13ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHByb2plY3RfcmVzdWx0X3RhYmxlIGZyb20gJ0AvY29tcG9uZW50cy9wcm9qZWN0X3Jlc3VsdF90YWJsZS52dWUnOwppbXBvcnQgcmVzdWx0IGZyb20gJ0AvYXBpL3Jlc3VsdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHJvamVjdFJlc3VsdCcsCiAgY29tcG9uZW50czogewogICAgcHJvamVjdF9yZXN1bHRfdGFibGU6IHByb2plY3RfcmVzdWx0X3RhYmxlCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICBmb3JtOiB7CiAgICAgICAgaW1wb3J0X2Zvcm06ICcnLAogICAgICAgIGRhdGUxOiAnJywKICAgICAgICBkZWxpdmVyeTogZmFsc2UsCiAgICAgICAgdHlwZTogW10sCiAgICAgICAgcmVzb3VyY2U6ICcnLAogICAgICAgIGRlc2M6ICcnCiAgICAgIH0sCiAgICAgIHRhYmxlRGF0YTogW10KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRBbGxSZXN1bHQoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEFsbFJlc3VsdDogZnVuY3Rpb24gZ2V0QWxsUmVzdWx0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmVzdWx0LmdldEFsbFJlc3VsdCgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIF90aGlzLnRhYmxlRGF0YSA9IHJlc3BvbnNlLmRhdGEucmVzdWx0TGlzdDsKICAgICAgfSk7CiAgICB9LAogICAgZXhwb3J0RXhjZWw6IGZ1bmN0aW9uIGV4cG9ydEV4Y2VsKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBhbGxjb2x1bW5zID0gdGhpcy50YWJsZURhdGE7CiAgICAgIHZhciBuZXdjb2x1bW5zID0gW107CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoYWxsY29sdW1ucyksCiAgICAgICAgICBfc3RlcDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByZSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgdmFyIHN0dWRlbnRzID0gJyc7CgogICAgICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyZS5zdHVkZW50TGlzdCksCiAgICAgICAgICAgICAgX3N0ZXAyOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgdmFyIHN0dWRlbnQgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICAgICAgc3R1ZGVudHMgKz0gc3R1ZGVudC5uYW1lICsgJywnOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBuZXdjb2x1bW5zLnB1c2goewogICAgICAgICAgICBpZDogcmUuaWQsCiAgICAgICAgICAgIGdyaWQ6IHJlLmdyaWQsCiAgICAgICAgICAgIGZpbmFsSWQ6IHJlLmZpbmFsSWQsCiAgICAgICAgICAgIHByb2plY3RUaXRsZTogcmUucHJvamVjdFRpdGxlLAogICAgICAgICAgICBzdHVkZW50OiBzdHVkZW50cywKICAgICAgICAgICAgcHJvamVjdENsaWVudDogcmUucHJvamVjdENsaWVudCwKICAgICAgICAgICAgcHJvamVjdEVtYWlsOiByZS5wcm9qZWN0RW1haWwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICByZXF1aXJlLmVuc3VyZShbXSwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfcmVxdWlyZSA9IHJlcXVpcmUoJy4uLy4uLy4uL2V4Y2VsL0V4cG9ydDJFeGNlbC5qcycpLAogICAgICAgICAgICBleHBvcnRfanNvbl90b19leGNlbCA9IF9yZXF1aXJlLmV4cG9ydF9qc29uX3RvX2V4Y2VsOwoKICAgICAgICB2YXIgdEhlYWRlciA9IFsnR3JvdXAgSUQnLCAnUHJvamVjdCBJRCcsICdQcm9qZWN0IE5hbWUnLCAnU3R1ZGVudHMnLCAnQ2xpZW50IG5hbWUnLCAnQ2xpZW50IEVtYWlsJ107IC8vIOS4iumdouiuvue9rkV4Y2Vs55qE6KGo5qC856ys5LiA6KGM55qE5qCH6aKYCgogICAgICAgIHZhciBmaWx0ZXJWYWwgPSBbJ2dyaWQnLCAnZmluYWxJZCcsICdwcm9qZWN0VGl0bGUnLCAnc3R1ZGVudCcsICdwcm9qZWN0Q2xpZW50JywgJ3Byb2plY3RFbWFpbCddOyAvLyDkuIrpnaLnmoRpbmRleOOAgW5pY2tOYW1l44CBbmFtZeaYr3RhYmxlRGF0YemHjOWvueixoeeahOWxnuaApwoKICAgICAgICB2YXIgbGlzdCA9IG5ld2NvbHVtbnM7IC8v5oqKZGF0YemHjOeahHRhYmxlRGF0YeWtmOWIsGxpc3QKCiAgICAgICAgdmFyIGRhdGEgPSBfdGhpczIuZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGxpc3QpOwoKICAgICAgICBleHBvcnRfanNvbl90b19leGNlbCh0SGVhZGVyLCBkYXRhLCAncHJvamVjdF9yZXN1bHRfdGFibGUnKTsKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0SnNvbjogZnVuY3Rpb24gZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGpzb25EYXRhKSB7CiAgICAgIHJldHVybiBqc29uRGF0YS5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICByZXR1cm4gZmlsdGVyVmFsLm1hcChmdW5jdGlvbiAoaikgewogICAgICAgICAgcmV0dXJuIHZbal07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,OAAA,oBAAA,MAAA,uCAAA;AACA,OAAA,MAAA,MAAA,cAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,eADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,oBAAA,EAAA;AADA,GAFA;AAMA,EAAA,IANA,kBAMA;AACA,WAAA;AACA,MAAA,iBAAA,EAAA,KADA;AAEA,MAAA,IAAA,EAAA;AACA,QAAA,WAAA,EAAA,EADA;AAEA,QAAA,KAAA,EAAA,EAFA;AAGA,QAAA,QAAA,EAAA,KAHA;AAIA,QAAA,IAAA,EAAA,EAJA;AAKA,QAAA,QAAA,EAAA,EALA;AAMA,QAAA,IAAA,EAAA;AANA,OAFA;AAWA,MAAA,SAAA,EAAA;AAXA,KAAA;AAcA,GArBA;AAsBA,EAAA,OAtBA,qBAsBA;AAEA,SAAA,YAAA;AACA,GAzBA;AA0BA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,0BACA;AAAA;;AACA,MAAA,MAAA,CAAA,YAAA,GAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,QAAA;AACA,QAAA,KAAA,CAAA,SAAA,GAAA,QAAA,CAAA,IAAA,CAAA,UAAA;AACA,OAHA;AAIA,KANA;AAOA,IAAA,WAPA,yBAOA;AAAA;;AACA,UAAA,UAAA,GAAA,KAAA,SAAA;AACA,UAAA,UAAA,GAAA,EAAA;;AAFA,iDAGA,UAHA;AAAA;;AAAA;AAGA,4DAAA;AAAA,cAAA,EAAA;AACA,cAAA,QAAA,GAAA,EAAA;;AADA,sDAEA,EAAA,CAAA,WAFA;AAAA;;AAAA;AAEA,mEAAA;AAAA,kBAAA,OAAA;AACA,cAAA,QAAA,IAAA,OAAA,CAAA,IAAA,GAAA,GAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;;AAKA,UAAA,UAAA,CAAA,IAAA,CAAA;AACA,YAAA,EAAA,EAAA,EAAA,CAAA,EADA;AAEA,YAAA,IAAA,EAAA,EAAA,CAAA,IAFA;AAGA,YAAA,OAAA,EAAA,EAAA,CAAA,OAHA;AAIA,YAAA,YAAA,EAAA,EAAA,CAAA,YAJA;AAKA,YAAA,OAAA,EAAA,QALA;AAMA,YAAA,aAAA,EAAA,EAAA,CAAA,aANA;AAOA,YAAA,YAAA,EAAA,EAAA,CAAA;AAPA,WAAA;AAUA;AAlBA;AAAA;AAAA;AAAA;AAAA;;AAoBA,MAAA,OAAA,CAAA,MAAA,CAAA,EAAA,EAAA,YAAA;AAAA,uBAGA,OAAA,CAAA,gCAAA,CAHA;AAAA,YAEA,oBAFA,YAEA,oBAFA;;AAIA,YAAA,OAAA,GAAA,CAAA,UAAA,EAAA,YAAA,EAAA,cAAA,EAAA,UAAA,EAAA,aAAA,EAAA,cAAA,CAAA,CAJA,CAKA;;AACA,YAAA,SAAA,GAAA,CAAA,MAAA,EAAA,SAAA,EAAA,cAAA,EAAA,SAAA,EAAA,eAAA,EAAA,cAAA,CAAA,CANA,CAOA;;AACA,YAAA,IAAA,GAAA,UAAA,CARA,CAQA;;AACA,YAAA,IAAA,GAAA,MAAA,CAAA,UAAA,CAAA,SAAA,EAAA,IAAA,CAAA;;AACA,QAAA,oBAAA,CAAA,OAAA,EAAA,IAAA,EAAA,sBAAA,CAAA;AACA,OAXA;AAYA,KAvCA;AAyCA,IAAA,UAzCA,sBAyCA,SAzCA,EAyCA,QAzCA,EAyCA;AACA,aAAA,QAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,eAAA,SAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,iBAAA,CAAA,CAAA,CAAA,CAAA;AAAA,SAAA,CAAA;AAAA,OAAA,CAAA;AACA;AA3CA;AA1BA,CAAA","sourcesContent":["<template>\r\n<div class=\"project-allocation-container\">\r\n    <div class=\"table_container\">\r\n        <div class=\"table_R\">\r\n            <project_result_table></project_result_table>\r\n        </div>\r\n        <div class=\"download\">\r\n            <el-button icon=\"el-icon-download\" circle @click=\"exportExcel()\"></el-button>\r\n\r\n        </div>\r\n    </div>\r\n    <el-dialog title=\"Import\" :visible.sync=\"dialogFormVisible\" width=\"30%\" height=\"30%\">\r\n        <el-form :model=\"form\">\r\n            <el-form-item label=\"Import as:\" :label-width=\"formLabelWidth\">\r\n                <el-select v-model=\"form.import_form\" placeholder=\"Select file format\">\r\n                    <el-option label=\"excel\" value=\"excel\"></el-option>\r\n                    <el-option label=\"doxc\" value=\"doxc\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\" style=\"background:#FFFFFF;\">\r\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n            <el-button type=\"primary\" pain @click=\"dialogFormVisible = false; exportExcel()\">确 定</el-button>\r\n        </div>\r\n    </el-dialog>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport project_result_table from '@/components/project_result_table.vue'\r\nimport result from '@/api/result'\r\nexport default {\r\n    name: 'ProjectResult',\r\n    components: {\r\n        project_result_table\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            dialogFormVisible: false,\r\n            form: {\r\n                import_form: '',\r\n                date1: '',\r\n                delivery: false,\r\n                type: [],\r\n                resource: '',\r\n                desc: ''\r\n            },\r\n\r\n            tableData: [],\r\n\r\n        }\r\n    },\r\n    created() {\r\n\r\n        this.getAllResult()\r\n    },\r\n    methods: {\r\n        getAllResult() {\r\n            result.getAllResult().then(response => {\r\n                console.log(response)\r\n                this.tableData = response.data.resultList\r\n            })\r\n        },\r\n        exportExcel() {\r\n            let allcolumns = this.tableData\r\n            var newcolumns = []\r\n            for (let re of allcolumns) {\r\n                var students = ''\r\n                for (let student of re.studentList) {\r\n                    students += (student.name + ',')\r\n                }\r\n                newcolumns.push({\r\n                    id: re.id,\r\n                    grid: re.grid,\r\n                    finalId: re.finalId,\r\n                    projectTitle: re.projectTitle,\r\n                    student: students,\r\n                    projectClient: re.projectClient,\r\n                    projectEmail: re.projectEmail\r\n                })\r\n\r\n            }\r\n\r\n            require.ensure([], () => {\r\n                const {\r\n                    export_json_to_excel\r\n                } = require('../../../excel/Export2Excel.js');\r\n                const tHeader = ['Group ID','Project ID', 'Project Name', 'Students', 'Client name','Client Email'];\r\n                // 上面设置Excel的表格第一行的标题\r\n                const filterVal = ['grid', 'finalId','projectTitle', 'student', 'projectClient','projectEmail'];\r\n                // 上面的index、nickName、name是tableData里对象的属性\r\n                const list = newcolumns; //把data里的tableData存到list\r\n                const data = this.formatJson(filterVal, list);\r\n                export_json_to_excel(tHeader, data, 'project_result_table');\r\n            })\r\n        },\r\n\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => v[j]))\r\n        }\r\n    }\r\n\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.project-allocation-container {\r\n    width: 1156px;\r\n    height: 702px;\r\n    font-size: 14px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.project-allocation-container .table_container {\r\n    width: 1128px;\r\n    height: 685px;\r\n    margin: 25px 20px;\r\n    border-radius: 6px;\r\n    box-shadow: 0 3px 6px 0 rgb(0 0 0 / 12%), 0 0 5px 0 rgb(0 0 0 / 4%);\r\n}\r\n\r\n.project-allocation-container .table_container .table_R {\r\n    width: 1128px;\r\n    height: 610px;\r\n}\r\n\r\n.download {\r\n    width: 1128px;\r\n    height: 70px;\r\n\r\n    .el-button {\r\n        float: right;\r\n        margin: 20px 51px 0 0;\r\n    }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/allocation/project_result"}]}